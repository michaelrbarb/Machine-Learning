<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Machine Learning by michaelrbarb</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Machine Learning</h1>
      <h2 class="project-tagline">JHU Machine Learning Coursera </h2>
      <a href="https://github.com/michaelrbarb/Machine-Learning" class="btn">View on GitHub</a>
      <a href="https://github.com/michaelrbarb/Machine-Learning/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/michaelrbarb/Machine-Learning/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="exercise-quality-" class="anchor" href="#exercise-quality-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Exercise Quality </h1>

<p><br></p>

<h3>
<a id="synopsis" class="anchor" href="#synopsis" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Synopsis</h3>

<p>Exercise is becoming an important part of general health for individuals and is of interest to the healthcare community as a whole.  Specifically, tracking the amount of exercise completed in a given time frame has been the focus of most fitness tracking devices. However, the future of exercise tracking will be determining the quality of exercise in addition to the quantity. This study will reference previously recorded exercise data in an attempt to predict quality of exercise from on-body and on-equipment sensor information.</p>

<h3>
<a id="data-processing-and-exploration" class="anchor" href="#data-processing-and-exploration" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Data Processing and Exploration</h3>

<p>The data utilized was sourced from the  <a href="http://groupware.les.inf.puc-rio.br/har">Human Activity Recognition and Weight Lifting Exercises</a> website.</p>

<p>The data was filtered to include only acceleration variables and sliced into a more managable data set.</p>

<div class="highlight highlight-source-r"><pre><span class="pl-smi">wleTrain2</span><span class="pl-k">&lt;-</span>select(<span class="pl-smi">wleTrain</span>,contains(<span class="pl-s"><span class="pl-pds">"</span>accel<span class="pl-pds">"</span></span>),contains(<span class="pl-s"><span class="pl-pds">"</span>classe<span class="pl-pds">"</span></span>))
<span class="pl-smi">wleTrain3</span><span class="pl-k">&lt;-</span>select(<span class="pl-smi">wleTrain2</span>,<span class="pl-k">-</span>contains(<span class="pl-s"><span class="pl-pds">"</span>var<span class="pl-pds">"</span></span>))
<span class="pl-smi">InTrain</span><span class="pl-k">&lt;-</span>createDataPartition(<span class="pl-v">y</span><span class="pl-k">=</span><span class="pl-smi">wleTrain3</span><span class="pl-k">$</span><span class="pl-smi">classe</span>,<span class="pl-v">p</span><span class="pl-k">=</span><span class="pl-c1">0.5</span>,<span class="pl-v">list</span><span class="pl-k">=</span><span class="pl-c1">FALSE</span>)
<span class="pl-smi">wleTrain4</span><span class="pl-k">&lt;-</span><span class="pl-smi">wleTrain3</span>[<span class="pl-smi">InTrain</span>,]
<span class="pl-smi">wleTest4</span><span class="pl-k">&lt;-</span><span class="pl-smi">wleTrain3</span>[<span class="pl-k">-</span><span class="pl-smi">InTrain</span>,]
<span class="pl-smi">InTrain</span><span class="pl-k">&lt;-</span>createDataPartition(<span class="pl-v">y</span><span class="pl-k">=</span><span class="pl-smi">wleTrain4</span><span class="pl-k">$</span><span class="pl-smi">classe</span>,<span class="pl-v">p</span><span class="pl-k">=</span><span class="pl-c1">0.7</span>,<span class="pl-v">list</span><span class="pl-k">=</span><span class="pl-c1">FALSE</span>)
<span class="pl-smi">wleTrain5</span><span class="pl-k">&lt;-</span><span class="pl-smi">wleTrain4</span>[<span class="pl-smi">InTrain</span>,]
<span class="pl-smi">wleTest5</span><span class="pl-k">&lt;-</span><span class="pl-smi">wleTrain4</span>[<span class="pl-k">-</span><span class="pl-smi">InTrain</span>,]</pre></div>

<p>The exercise dataset was examined and exploratory plots were drawn with R.  The plots that illustrated interesting trends were <em>accel dumbbell y</em> vs <em>accel belt z</em> variables and <em>accel belt z</em> vs <em>accel dumbbell y</em> variables as shown below.  Accleration less than about -200 at the belt location in the z direction appear to all be of class E.  Additionally, class A and D show somewhat tight clusters on both plots.  Due to these observations classification and random forest models were deemed the most approriate model for the data.
<br>
<img src="unnamed-chunk-3-1.png" title="" alt=""><img src="unnamed-chunk-3-2.png" title="" alt=""></p>

<h3>
<a id="model-training-and-testing" class="anchor" href="#model-training-and-testing" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Model Training and Testing</h3>

<p>The rpart function from the caret package was used for prediction utilizing classification methodology.  Cross validation was implemented with the a K-fold of 5, a value not too big nor small which will keep bias and variance between the predicted and actual values within reason.  The R code and results are below.</p>

<div class="highlight highlight-source-r"><pre>set.seed(<span class="pl-c1">33833</span>)
<span class="pl-smi">modFitrpart</span><span class="pl-k">&lt;-</span>train(<span class="pl-smi">classe</span><span class="pl-k">~</span>.,<span class="pl-v">method</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>rpart<span class="pl-pds">'</span></span>,<span class="pl-v">data</span><span class="pl-k">=</span><span class="pl-smi">wleTrain5</span>,<span class="pl-v">trControl</span><span class="pl-k">=</span>trainControl(<span class="pl-v">method</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>cv<span class="pl-pds">"</span></span>,<span class="pl-v">number</span><span class="pl-k">=</span><span class="pl-c1">5</span>))
print(<span class="pl-smi">modFitrpart</span><span class="pl-k">$</span><span class="pl-smi">finalModel</span>)</pre></div>

<pre><code>## n= 13737 
## 
## node), split, n, loss, yval, (yprob)
##       * denotes terminal node
## 
##  1) root 13737 9831 A (0.28 0.19 0.17 0.16 0.18)  
##    2) accel_belt_z&gt;=-186.5 13035 9137 A (0.3 0.2 0.18 0.17 0.14)  
##      4) accel_arm_x&lt; -270.5 2268  833 A (0.63 0.1 0.14 0.047 0.074) *
##      5) accel_arm_x&gt;=-270.5 10767 8304 A (0.23 0.22 0.19 0.2 0.15)  
##       10) accel_forearm_x&gt;=-104.5 6336 4668 A (0.26 0.26 0.22 0.093 0.17) *
##       11) accel_forearm_x&lt; -104.5 4431 2877 D (0.18 0.18 0.16 0.35 0.13) *
##    3) accel_belt_z&lt; -186.5 702    8 E (0.011 0 0 0 0.99) *
</code></pre>

<div class="highlight highlight-source-r"><pre>print(<span class="pl-smi">modFitrpart</span>)</pre></div>

<pre><code>## CART 
## 
## 13737 samples
##    16 predictor
##     5 classes: 'A', 'B', 'C', 'D', 'E' 
## 
## No pre-processing
## Resampling: Cross-Validated (5 fold) 
## Summary of sample sizes: 10989, 10991, 10989, 10990, 10989 
## Resampling results across tuning parameters:
## 
##   cp          Accuracy   Kappa     
##   0.02366663  0.4374364  0.27526388
##   0.03860238  0.3547352  0.12231086
##   0.06977927  0.3031189  0.02873436
## 
## Accuracy was used to select the optimal model using  the largest value.
## The final value used for the model was cp = 0.02366663.
</code></pre>

<div class="highlight highlight-source-r"><pre><span class="pl-smi">pred_rpart</span><span class="pl-k">&lt;-</span>predict(<span class="pl-smi">modFitrpart</span>,<span class="pl-smi">wleTest5</span>)
table(<span class="pl-smi">pred_rpart</span>,<span class="pl-smi">wleTest5</span><span class="pl-k">$</span><span class="pl-smi">classe</span>)</pre></div>

<pre><code>##           
## pred_rpart    A    B    C    D    E
##          A 1315  790  717  328  485
##          B    0    0    0    0    0
##          C    0    0    0    0    0
##          D  354  349  309  636  260
##          E    5    0    0    0  337
</code></pre>

<p>The best model had an Accuracy of 44% (56% classification error).  The rpart model was used to predict the test set to validate the error rate from the rpart function. Results from applying the model to the test data is shown above.  The accuracy using rpart on the test model was  <strong>38.88%</strong>; similar value to the rpart generated accuracy indicating that the model only predicts approximately 40% of the correct responses of any given data set.</p>

<p>The accuracy and classification error values were less than ideal, therefore a random forest approach was used.  The random forest model was implemented with the caret package and a K-fold value of 5.  The model was validated by applying it to the test set. The out of bag estimate, or out of sample error of the random forest model was estimated at 5.49%.  Additionally, the worst classification error was only 8.88% for classe <em>B</em>.  Both values indicate a strong model with high prediction power.</p>

<div class="highlight highlight-source-r"><pre>set.seed(<span class="pl-c1">33833</span>)
<span class="pl-smi">modFit</span> <span class="pl-k">&lt;-</span> train(<span class="pl-smi">classe</span> <span class="pl-k">~</span> .,<span class="pl-v">method</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>rf<span class="pl-pds">"</span></span>,<span class="pl-v">trControl</span><span class="pl-k">=</span>trainControl(<span class="pl-v">method</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>cv<span class="pl-pds">"</span></span>,<span class="pl-v">number</span><span class="pl-k">=</span><span class="pl-c1">5</span>),
                <span class="pl-v">savePredictions</span> <span class="pl-k">=</span> <span class="pl-c1">T</span>,<span class="pl-v">data</span><span class="pl-k">=</span><span class="pl-smi">wleTrain5</span>)
print(<span class="pl-smi">modFit</span>)</pre></div>

<pre><code>## Random Forest 
## 
## 13737 samples
##    16 predictor
##     5 classes: 'A', 'B', 'C', 'D', 'E' 
## 
## No pre-processing
## Resampling: Cross-Validated (5 fold) 
## Summary of sample sizes: 10989, 10991, 10989, 10990, 10989 
## Resampling results across tuning parameters:
## 
##   mtry  Accuracy   Kappa    
##    2    0.9384879  0.9221645
##    9    0.9322275  0.9142193
##   16    0.9198515  0.8985570
## 
## Accuracy was used to select the optimal model using  the largest value.
## The final value used for the model was mtry = 2.
</code></pre>

<div class="highlight highlight-source-r"><pre>print(<span class="pl-smi">modFit</span><span class="pl-k">$</span><span class="pl-smi">finalModel</span>)</pre></div>

<pre><code>## 
## Call:
##  randomForest(x = x, y = y, mtry = param$mtry, savePredictions = ..1) 
##                Type of random forest: classification
##                      Number of trees: 500
## No. of variables tried at each split: 2
## 
##         OOB estimate of  error rate: 5.49%
## Confusion matrix:
##      A    B    C    D    E class.error
## A 3769   30   50   54    3  0.03507424
## B  105 2422   84   23   24  0.08878856
## C   39   61 2265   26    5  0.05467446
## D   42   16  104 2085    5  0.07415631
## E    4   33   21   25 2442  0.03287129
</code></pre>

<div class="highlight highlight-source-r"><pre><span class="pl-smi">pred_rf</span><span class="pl-k">&lt;-</span>predict(<span class="pl-smi">modFit</span>,<span class="pl-smi">wleTest5</span>)
table(<span class="pl-smi">pred_rf</span>,<span class="pl-smi">wleTest5</span><span class="pl-k">$</span><span class="pl-smi">classe</span>) </pre></div>

<pre><code>##        
## pred_rf    A    B    C    D    E
##       A 1616   45   12   28    1
##       B   11 1046   26    8   13
##       C   23   29  972   44    7
##       D   22   10   12  881    9
##       E    2    9    4    3 1052
</code></pre>

<p>The model was applied to the test set and the classification error was calculated as <strong>5.4%</strong> indicating that a small percentage of the data was indeed incorrectly categorized. The actual prediction table can be viewed above. Additionally, the calculated classification error is similar to the value generated by the random forest R function thereby validating our model was constructed correctly. The random forest model is superior to the rpart classifcation model used above and was utilized as the final model for quiz 4.
A characteristic of the random forest model worth noting is that after examining variable importance it is clear that the <em>accel dumbbel y</em>, <em>accel belt z</em> and <em>accel dumbbel z</em> are the top variables in predicting the exercise classe which could prove useful in future studies or data collection for exercise tracking devices.
<br>
<img src="unnamed-chunk-8-1.png" title="" alt=""></p>

<h3>
<a id="conclusion" class="anchor" href="#conclusion" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Conclusion</h3>

<p>Exercise data and the method at which we track and report that information will continue to be important to the health conscious person.  Results from human activity recognition experiments will help to further development of fitness trackers thanks to machine learning techniques employed by data scientists. The decision trees and random forests models will be important tools to use in future development of health and fitness trackers as evidenced by the weight lifting exercise data examined in this study. </p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/michaelrbarb/Machine-Learning">Machine Learning</a> is maintained by <a href="https://github.com/michaelrbarb">michaelrbarb</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
